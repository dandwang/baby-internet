<!DOCTYPE html>  
<html>  
    <head>  
        <meta charset="utf-8">
        <title>Canvas测试</title>  
        <meta charset="gbk">  
        <script>  
            //绘制饼图  
            function drawCircle(canvasId, data_arr,  total_time)  
            {  
                var color_arr = ["#f2604d", "#92db49", "#3898d6", "#f3c637","#f7a449"];  
                var c = document.getElementById(canvasId);  
                var ctx = c.getContext("2d");  
  
                var radius = c.height / 2 ; //半径  
                var ox = radius , oy = radius ; //圆心  
                var nradius=radius-30;  //内环半径
                var width = 30, height = 10; //图例宽和高  
                var posX = ox * 2 + 20, posY = 30;   //  
               // var textX = posX + width + 5, textY = posY + 10;  
                var textX= c.width/2-(total_time.length*10/2);

                var startAngle = 0; //起始弧度  
                var endAngle = 0;   //结束弧度  
                for (var i = 0; i < data_arr.length; i++)  
                {  
                    //绘制饼图  
                    endAngle = endAngle + data_arr[i] * Math.PI * 2; //结束弧度  
                    ctx.fillStyle = color_arr[i];  
                    ctx.beginPath();  
                    ctx.moveTo(ox, oy); //移动到到圆心  
                    ctx.arc(ox, oy, radius, startAngle, endAngle, false);  
                    ctx.closePath();  
                    ctx.fill();  
                    startAngle = endAngle; //设置起始弧度  
                }
                
                ctx.beginPath();  
                ctx.fillStyle='#fff';
                ctx.moveTo(ox, oy); //移动到到圆心  
                ctx.arc(ox,oy,nradius,0,2*Math.PI) ; 
                ctx.closePath();  
                ctx.fill();

                ctx.beginPath()
                ctx.fillStyle='#999';
                ctx.font = "15px serif";
                ctx.fillText("合计上网", 45, 60);
                ctx.closePath()

                ctx.fillStyle='#000';
                ctx.font = "20px serif";
                ctx.fillText(total_time, textX, 90);
            }  
  
            function init() {  
                //绘制饼图  
                //比例数据和颜色  
                var data_arr = [0.2, 0.2, 0.2, 0.2,0.2];  
                var color_arr = ["#f2604d", "#92db49", "#3898d6", "#f3c637","#f7a449"];  
               // var text_arr = ["第一季度", "第二季度", "第三季度", "第四季度"];  
                var total_time='1:1'
             //  drawCircle("canvas_circle", data_arr, color_arr, text_arr);  
                drawCircle("canvas_circle", data_arr,  total_time)
            }  
  
            //页面加载时执行init()函数  
            window.onload = init;  
        </script>  
    </head>  
    <body>  
        <h3>HTML5绘制饼图演示</h3>  
        <p>  
            <canvas id="canvas_circle" width="150" height="150"  >  
                浏览器不支持canvas  
            </canvas>  
        </p>  
    </body>  

</html>  

